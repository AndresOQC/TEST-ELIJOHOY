import{V as F,r as k,t as f,O as J,a as m,o as l,w as a,aQ as B,X as R,h as o,ai as c,g as u,f as s,i as h,U as r,P as Q,S,k as d,an as $,Q as T,aj as D,ak as V,af as A}from"./index-5Qe94oD6.js";import{Q as v}from"./QChip-BMz6Wa9U.js";import{Q as L,a as y,b as x}from"./QItem-CCjK1OtG.js";import{Q as M}from"./QBadge-DnEhrt1x.js";import{Q as j}from"./QList-VINSO3Bo.js";import{Q as O}from"./QPage-DYnFy_zN.js";import{u as U}from"./use-quasar-CK-YrpUA.js";import{_ as X}from"./_plugin-vue_export-helper-DlAUqK2U.js";const G={class:"row q-col-gutter-lg"},H={class:"col-12"},K={class:"page-header"},W={class:"row items-center"},Y={class:"text-body1 text-grey-7"},Z={key:0,class:"col-12"},ee={class:"row q-gutter-md items-center"},te={class:"col-auto"},oe={class:"col-auto"},se={class:"col-auto"},ae={class:"col-12"},re={key:0,class:"text-center q-py-xl"},le={key:1,class:"text-center q-py-xl"},ie={class:"text-h6 text-grey-7 q-mb-md"},ne={key:2,class:"sesiones-list"},ce={class:"row q-gutter-sm"},de={key:0},ue={key:1},pe={class:"text-right"},me={class:"text-caption text-grey-7"},_e={__name:"TestResultadosPage",setup(ge){const q=R(),_=U(),C=F(),g=k(!1),n=k([]),p=f(()=>C.user?.roles?.some(t=>t.nombre==="administrador")||!1),E=f(()=>n.value.filter(t=>t.completado)),P=f(()=>n.value.filter(t=>!t.completado)),b=t=>t?new Date(t).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",N=t=>({INTJ:"purple",INTP:"blue",ENTJ:"red",ENTP:"orange",INFJ:"pink",INFP:"green",ENFJ:"yellow",ENFP:"cyan",ISTJ:"brown",ISFJ:"teal",ESTJ:"deep-orange",ESFJ:"lime",ISTP:"indigo",ISFP:"light-green",ESTP:"amber",ESFP:"light-blue"})[t]||"grey",I=async()=>{g.value=!0;try{const t=await B.get("/test/mis-sesiones");t.data.success?(n.value=t.data.sesiones,console.log("Sesiones cargadas:",n.value)):_.notify({type:"negative",message:"Error al cargar sesiones",icon:"error"})}catch(t){console.error("Error cargando sesiones:",t),_.notify({type:"negative",message:"Error de conexión al cargar sesiones",icon:"error"})}finally{g.value=!1}},w=t=>{t.completado?q.push(`/dashboard/test-resultados/${t.id_sesion}`):_.notify({type:"warning",message:"Este test aún no está completado",icon:"warning"})};return J(()=>{I()}),(t,i)=>(l(),m(O,{class:"test-resultados-page q-pa-lg"},{default:a(()=>[o("div",G,[o("div",H,[o("div",K,[o("div",W,[s(h,{name:"quiz",size:"48px",color:"purple-7",class:"q-mr-md"}),o("div",null,[i[1]||(i[1]=o("h1",{class:"text-h4 text-weight-bold",style:{color:"#7C3AED"}}," Resultados de Tests ",-1)),o("p",Y,r(p.value?"Administra todos los tests realizados":"Tus tests vocacionales completados"),1)])])])]),p.value?(l(),c("div",Z,[s(Q,{flat:"",bordered:"",class:"q-mb-lg"},{default:a(()=>[s(S,null,{default:a(()=>[o("div",ee,[i[2]||(i[2]=o("div",{class:"col-auto"},[o("div",{class:"text-h6 text-weight-bold"},"Estadísticas")],-1)),o("div",te,[s(v,{color:"primary","text-color":"white"},{default:a(()=>[d(" Total: "+r(n.value.length),1)]),_:1})]),o("div",oe,[s(v,{color:"positive","text-color":"white"},{default:a(()=>[d(" Completados: "+r(E.value.length),1)]),_:1})]),o("div",se,[s(v,{color:"warning","text-color":"white"},{default:a(()=>[d(" Pendientes: "+r(P.value.length),1)]),_:1})])])]),_:1})]),_:1})])):u("",!0),o("div",ae,[s(Q,{flat:"",bordered:""},{default:a(()=>[s(S,null,{default:a(()=>[g.value?(l(),c("div",re,[s($,{color:"primary",size:"50px"}),i[3]||(i[3]=o("p",{class:"text-body1 text-grey-7 q-mt-md"},"Cargando resultados...",-1))])):n.value.length===0?(l(),c("div",le,[s(h,{name:"quiz",size:"80px",color:"grey-5",class:"q-mb-lg"}),o("div",ie,r(p.value?"No hay tests realizados aún":"No has completado ningún test aún"),1),s(T,{unelevated:"",color:"primary",icon:"quiz",label:"Realizar Test",onClick:i[0]||(i[0]=e=>t.$router.push("/dashboard/test")),"no-caps":""})])):(l(),c("div",ne,[s(j,{separator:""},{default:a(()=>[(l(!0),c(D,null,V(n.value,e=>(l(),m(L,{key:e.id_sesion,clickable:"",onClick:z=>w(e),class:"sesion-item"},{default:a(()=>[s(y,{avatar:""},{default:a(()=>[s(h,{name:e.completado?"check_circle":"pending",color:e.completado?"positive":"warning",size:"32px"},null,8,["name","color"])]),_:2},1024),s(y,null,{default:a(()=>[s(x,{class:"text-weight-bold"},{default:a(()=>[d(" Test #"+r(e.id_sesion)+" ",1),e.tipo_personalidad?(l(),m(M,{key:0,color:N(e.tipo_personalidad),class:"q-ml-sm"},{default:a(()=>[d(r(e.tipo_personalidad),1)]),_:2},1032,["color"])):u("",!0)]),_:2},1024),s(x,{caption:""},{default:a(()=>[o("div",ce,[o("span",null,"📅 "+r(b(e.fecha_inicio)),1),e.fecha_fin?(l(),c("span",de,"⏱️ "+r(b(e.fecha_fin)),1)):u("",!0),p.value&&e.usuario?(l(),c("span",ue," 👤 "+r(e.usuario.nombre)+" "+r(e.usuario.apellidos),1)):u("",!0)])]),_:2},1024),e.completado&&e.tipo?(l(),m(x,{key:0,caption:""},{default:a(()=>[d(r(e.tipo.nombre)+" - "+r(e.tipo.descripcion_corta),1)]),_:2},1024)):u("",!0)]),_:2},1024),s(y,{side:""},{default:a(()=>[o("div",pe,[o("div",me,r(e.completado?"Completado":"Pendiente"),1),s(T,{flat:"",dense:"",round:"",icon:"arrow_forward",color:"primary",onClick:A(z=>w(e),["stop"])},null,8,["onClick"])])]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]))]),_:1})]),_:1})])])]),_:1}))}},Qe=X(_e,[["__scopeId","data-v-b1be30da"]]);export{Qe as default};
