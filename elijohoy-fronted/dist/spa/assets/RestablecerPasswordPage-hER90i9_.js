import{d as P,a as u,o as p,w as r,r as l,t as k,O as x,ah as q,X as Q,ag as R,h as n,f as t,P as V,S as g,i,Y as y,Q as m}from"./index-B18p3XXK.js";import{Q as $}from"./QForm-BPISJrUk.js";import{Q as z}from"./QPage-C3BAbOyK.js";import{u as D}from"./use-quasar-gRLwgNsu.js";import{_ as I}from"./_plugin-vue_export-helper-DlAUqK2U.js";const N=P({name:"RestablecerPasswordPage",setup(){const e=D(),o=q(),w=Q(),c=l({new_password:"",confirm_password:""}),f=l(!1),v=l(!1),a=l(!1),b=l(!1),d=l(""),h=k(()=>[s=>!!s||"La contraseña es requerida",s=>s.length>=8||"Mínimo 8 caracteres",s=>/[A-Z]/.test(s)||"Debe contener al menos una mayúscula",s=>/[a-z]/.test(s)||"Debe contener al menos una minúscula",s=>/[0-9]/.test(s)||"Debe contener al menos un número",s=>/[!@#$%^&*(),.?":{}|<>]/.test(s)||"Debe contener al menos un símbolo"]),C=async()=>{if(!d.value){e.notify({message:"Token inválido o expirado",color:"negative",icon:"error",position:"top"});return}a.value=!0;try{const s=await R.resetPassword(d.value,c.value.new_password);s.success?(b.value=!0,e.notify({message:"¡Contraseña restablecida exitosamente!",color:"positive",icon:"check_circle",position:"top"})):e.notify({message:s.message||"Error al restablecer la contraseña",color:"negative",icon:"error",position:"top"})}catch(s){console.error("Reset password error:",s),e.notify({message:"Error de conexión. Por favor intenta nuevamente.",color:"negative",icon:"error",position:"top"})}finally{a.value=!1}};return x(()=>{d.value=o.params.token,d.value||(e.notify({message:"Token de restablecimiento inválido",color:"negative",icon:"error",position:"top"}),w.push("/auth/login"))}),{form:c,showPassword:f,showConfirmPassword:v,loading:a,passwordReset:b,passwordRules:h,resetPassword:C}}}),S={class:"reset-container"},_={class:"reset-icon-wrapper q-mb-lg"},A={class:"success-icon-wrapper q-mb-md"},B={class:"text-center q-mt-md"};function E(e,o,w,c,f,v){return p(),u(z,{class:"reset-page"},{default:r(()=>[n("div",S,[t(V,{class:"reset-card glass-card"},{default:r(()=>[e.passwordReset?(p(),u(g,{key:1,class:"text-center"},{default:r(()=>[n("div",A,[t(i,{name:"check_circle",size:"64px",color:"white"})]),o[8]||(o[8]=n("div",{class:"text-h4 text-weight-bold text-white q-mb-sm"}," ¡Contraseña Restablecida! ",-1)),o[9]||(o[9]=n("div",{class:"text-body1 text-white-7 q-mb-lg"}," Tu contraseña ha sido restablecida exitosamente. Ahora puedes iniciar sesión con tu nueva contraseña. ",-1)),t(m,{unelevated:"",size:"lg",color:"yellow-9","text-color":"purple-10",label:"Ir al Login",icon:"login",to:"/auth/login",class:"full-width btn-gradient","no-caps":""})]),_:1})):(p(),u(g,{key:0,class:"text-center"},{default:r(()=>[n("div",_,[t(i,{name:"vpn_key",size:"52px",color:"white"})]),o[5]||(o[5]=n("div",{class:"text-h4 text-weight-bold text-white q-mb-sm"}," Nueva Contraseña ",-1)),o[6]||(o[6]=n("div",{class:"text-h6 text-weight-medium text-yellow-9 q-mb-sm"}," Ya casi terminamos ",-1)),o[7]||(o[7]=n("div",{class:"text-body1 text-white-7 q-mb-lg"}," Crea una contraseña segura para completar el restablecimiento ",-1)),t($,{onSubmit:e.resetPassword,class:"q-gutter-md"},{default:r(()=>[t(y,{modelValue:e.form.new_password,"onUpdate:modelValue":o[1]||(o[1]=a=>e.form.new_password=a),type:e.showPassword?"text":"password",label:"Nueva Contraseña",outlined:"",color:"purple-7",rules:e.passwordRules,"lazy-rules":"",class:"modern-input"},{prepend:r(()=>[t(i,{name:"lock",color:"purple-7"})]),append:r(()=>[t(i,{name:e.showPassword?"visibility":"visibility_off",class:"cursor-pointer",color:"purple-7",onClick:o[0]||(o[0]=a=>e.showPassword=!e.showPassword)},null,8,["name"])]),hint:r(()=>[...o[4]||(o[4]=[n("div",{class:"text-caption",style:{color:"#7C3AED"}}," Mín. 8 caracteres, una mayúscula, una minúscula, un número y un símbolo ",-1)])]),_:1},8,["modelValue","type","rules"]),t(y,{modelValue:e.form.confirm_password,"onUpdate:modelValue":o[3]||(o[3]=a=>e.form.confirm_password=a),type:e.showConfirmPassword?"text":"password",label:"Confirmar Nueva Contraseña",outlined:"",color:"purple-7",rules:[a=>!!a||"Confirma tu contraseña",a=>a===e.form.new_password||"Las contraseñas no coinciden"],"lazy-rules":"",class:"modern-input"},{prepend:r(()=>[t(i,{name:"lock_check",color:"purple-7"})]),append:r(()=>[t(i,{name:e.showConfirmPassword?"visibility":"visibility_off",class:"cursor-pointer",color:"purple-7",onClick:o[2]||(o[2]=a=>e.showConfirmPassword=!e.showConfirmPassword)},null,8,["name"])]),_:1},8,["modelValue","type","rules"]),t(m,{unelevated:"",type:"submit",size:"lg",color:"yellow-9","text-color":"purple-10",label:"Restablecer Contraseña","icon-right":"check_circle",class:"full-width btn-gradient text-weight-bold",loading:e.loading,"no-caps":""},null,8,["loading"])]),_:1},8,["onSubmit"])]),_:1}))]),_:1}),n("div",B,[t(m,{flat:"","no-caps":"",color:"white",label:"Volver al Inicio",to:"/",icon:"arrow_back"})])])]),_:1})}const F=I(N,[["render",E],["__scopeId","data-v-8dccf705"]]);export{F as default};
